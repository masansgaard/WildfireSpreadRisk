PROC SQL;
DROP TABLE WORK.AREA_DATA_ONLY_MINUS_OUTLIERS;
CREATE TABLE WORK.AREA_DATA_ONLY_MINUS_OUTLIERS AS
SELECT * FROM WORK.RAW_FIRE_DATA WHERE AREA>0 and area<300 ;
QUIT;

proc sql;

create table work.FIRES_DATA_1 as
select *, (ffmc/(select max(ffmc) from WORK.AREA_DATA_ONLY_MINUS_OUTLIERS)) as FFMC_Ratio 
, (dmc/(select max(dmc) from WORK.AREA_DATA_ONLY_MINUS_OUTLIERS)) as DMC_Ratio 
, (DC/(select max(DC) from WORK.AREA_DATA_ONLY_MINUS_OUTLIERS)) as DC_Ratio 
,(ISI/(select max(ISI) from WORK.AREA_DATA_ONLY_MINUS_OUTLIERS)) as ISI_Ratio 
from WORK.AREA_DATA_ONLY_MINUS_OUTLIERS;
quit;

proc sql;
DROP TABLE WORK.FIRES_DATA_FINAL;
quit;
proc sql;

CREATE TABLE WORK.FIRES_DATA_FINAL AS
select t.*, WILDFIRE_SPREAD_SCORE/max(WILDFIRE_SPREAD_SCORE) as Wildfire_Comparative_Metric
from (
SELECT F.*, 

((FFMC*(SELECT WEIGHT FROM WORK.TEMP_DATA WHERE TYPE='FFMC'))+(DMC*(SELECT WEIGHT FROM WORK.TEMP_DATA WHERE TYPE='DMC'))+(DC*(SELECT WEIGHT FROM WORK.TEMP_DATA WHERE TYPE='DC'))/3) AS WILDFIRE_SPREAD_SCORE

FROM WORK.FIRES_DATA_1 F, WORK.TEMP_DATA A) t
;

QUIT;

PROC TTEST DATA=WORK.AREA_DATA_ONLY_MINUS_OUTLIERS;
PAIRED FFMC*AREA;
RUN;
PROC TTEST DATA=WORK.AREA_DATA_ONLY_MINUS_OUTLIERS;
PAIRED DMC*AREA;
RUN;
PROC TTEST DATA=WORK.AREA_DATA_ONLY_MINUS_OUTLIERS;
PAIRED DC*AREA;
RUN;
PROC TTEST DATA=WORK.AREA_DATA_ONLY_MINUS_OUTLIERS;
PAIRED ISI*AREA;
RUN;

proc corr data = WORK.AREA_DATA_ONLY_MINUS_OUTLIERS PLOTS=MATRIX; 
VAR FFMC DMC DC ISI AREA;
run;

data temp_data;
input type $ weight;
datalines;
FFMC 0.050963391	
DMC 0.848362235	
DC 0.100674374	
;
run;

proc corr data = FIRES_DATA_FINAL plots = matrix ;
VAR Wildfire_Comparative_Metric area ;
run;
